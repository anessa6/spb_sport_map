# Спортивные объекты Санкт-Петербурга

Интерактивная веб-карта спортивных объектов Санкт-Петербурга с возможностью поиска, фильтрации и визуализации данных.

## Описание проекта

Веб-приложение для отображения и анализа спортивных объектов Санкт-Петербурга на интерактивной карте. Проект включает в себя полноценный REST API на Flask и современный фронтенд на OpenLayers с адаптивным дизайном.

## Функциональные возможности

### Основной функционал
- **Интерактивная карта** с кластеризацией объектов
- **Живой поиск** с подсказками в реальном времени
- **Фильтрация** по районам и видам спорта
- **Детальная информация** о каждом объекте во всплывающих окнах
- **Статистические графики** по районам
- **Адаптивный дизайн** для мобильных устройств

### Технические особенности
- Разделение на frontend и backend
- REST API для доступа к данным
- Кластеризация объектов на карте
- Динамическая фильтрация без перезагрузки страницы
- Визуализация данных с помощью Chart.js
- Оптимизированные запросы к базе данных

## Технологический стек

### Backend
- **Python 3.13**
- **Flask** - веб-фреймворк
- **PostgreSQL / MySQL** - база данных (поддерживаются обе)
- **psycopg2 / mysql-connector-python** - драйверы для БД
- **Flask-CORS** - обработка CORS запросов
- **python-dotenv** - управление переменными окружения

### Frontend
- **HTML5/CSS3**
- **JavaScript (ES6+)**
- **OpenLayers** - библиотека для работы с картами
- **Chart.js** - библиотека для графиков
- **Font Awesome** - иконки
- **Vite** - сборщик модулей

## Структура базы данных

### Таблица `sports_objects`

Содержит 2663 записи о спортивных объектах с полями:
- `id` - уникальный идентификатор
- `district` - район Санкт-Петербурга
- `address` - адрес объекта
- `name` - название объекта
- `object_type` - тип объекта (площадка, комплекс, каток и т.д.)
- `latitude`, `longitude` - координаты
- `sports` - виды спорта
- `phone`, `email`, `website` - контактная информация
- `status` - статус работы
- `cost` - стоимость услуг
- `facilities` - оборудование
- И другие характеристики объекта

## Установка и запуск

### Требования
- Python 3.13+
- MySQL 8.0+ (или Docker)
- Node.js 16+
- npm

### Быстрый старт с Docker (рекомендуется)

Самый простой способ - использовать Docker для MySQL:

```bash
# 1. Запустить MySQL в Docker
docker-compose up -d

# 2. Скопировать настройки подключения
copy api\.env.docker api\.env

# 3. Установить зависимости Python
cd api
pip install -r requirements.txt

# 4. Создать базу данных
python create_database_mysql.py

# 5. Запустить API
python app_mysql.py

# 6. Установить зависимости Node.js (в новом окне)
cd map
npm install

# 7. Запустить фронтенд
npm run dev
```

Откройте http://localhost:5173

**Управление в Docker:**
```bash
# Проверить статус
docker-compose ps

# Остановить MySQL
docker-compose down

# Перезапустить
docker-compose restart
```

**Если порт 3306 занят:**
Измените порт в `docker-compose.yml` на `"3307:3306"` и в `.env` укажите `DB_PORT=3307`

---

### Установка без Docker

1. **Клонируйте репозиторий**

```bash
git clone <repository-url>
cd <project-folder>
```

2. **Настройка базы данных**

Создайте файл `api/.env`:
```
DB_PASSWORD=ПАРОЛЬ_СУБД
```

3. **Установка зависимостей Python**

```bash
cd api
pip install -r requirements.txt
```

4. **Создание и заполнение базы данных**

```bash
python create_database_mysql.py
```

Подробная инструкция по миграции на MySQL: [MIGRATION_MYSQL.md](MIGRATION_MYSQL.md)

5. **Установка зависимостей Node.js**
```bash
cd ../map
npm install
```

### Запуск

1. **Запуск API сервера**

```bash
cd api
python app.py
```

API будет доступен на `http://localhost:5000`

2. **Запуск фронтенда**
```bash
cd map
npm start
```
Приложение будет доступно на `http://localhost:5173`

## API Endpoints

### Спортивные объекты
- `GET /api/sports` - получить все объекты
- `GET /api/sports/<id>` - получить объект по ID
- `GET /api/districts` - получить список районов
- `GET /api/sport-types` - получить список видов спорта
- `GET /api/stats` - получить статистику

### Примеры запросов

```bash
# Получить все объекты
curl http://localhost:5000/api/sports

# Получить статистику
curl http://localhost:5000/api/stats

# Получить список районов
curl http://localhost:5000/api/districts
```

## Особенности интерфейса

### Дизайн
- Полноэкранная карта в стиле Google Maps/Яндекс.Карты
- Плавающие панели управления
- Современные UI элементы с тенями и закругленными углами
- Цветовая кодировка объектов по типам

### Интерактивность
- Кластеризация объектов с настраиваемыми параметрами
- Живой поиск с подсветкой совпадений
- Всплывающие окна с детальной информацией
- Анимированные переходы и масштабирование

### Адаптивность
- Оптимизация для мобильных устройств
- Скрывающиеся панели на маленьких экранах
- Плавающие кнопки управления для мобильных

## Статистика и визуализация

- **Общая статистика**: количество объектов, видимых на карте
- **Графики**: топ-5 районов по количеству объектов
- **Легенда**: цветовая кодировка типов объектов
- **Кластеризация**: визуальная группировка близких объектов

## Безопасность

- Использование переменных окружения для конфиденциальных данных
- CORS настроен для конкретного origin
- Параметризованные SQL запросы для защиты от SQL-инъекций
- Валидация входных данных

## Источник данных

Данные о спортивных объектах Санкт-Петербурга получены из открытых источников и содержат информацию о:
- Спортивных площадках
- Спортивных комплексах
- Катках
- Других спортивных сооружениях

Ссылки:
https://data.gov.spb.ru/irsi/7803050795-perechen-gosudarstvennyh-uchrezhdenij-fizicheskoj-kultury-i-sporta-v-Sankt-Peterburge/structure_version/425/
https://data.gov.spb.ru/irsi/7830002078-Perechen-gosudarstvennyh-uchrezhdenij-fizicheskoj-kultury-i-sporta-v-Sankt-Peterburge/structure_version/359/
https://data.gov.spb.ru/irsi/7803050795-Obuekty-fizicheskoj-kultury-i-sporta-Sankt-Petersburg/structure_version/703/

Всего в базе 2663 объекта